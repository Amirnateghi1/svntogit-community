# $Id: PKGBUILD,v 1.31 2009/06/19 18:48:18 BaSh Exp $
# Maintainer: Andrea Scarpino <andrea@archlinux.org>
# Contributor: FUBAR <mrfubar@gmail.com>

pkgname=shorewall
pkgver=4.2.10
pkgrel=1
pkgdesc="An iptables-based firewall for Linux systems"
arch=('i686' 'x86_64')
url="http://www.shorewall.net"
backup=(etc/shorewall/{shorewall.conf,zones,functions,policy,interfaces,ipsec,hosts,rules,nat,netmap,params,proxyarp,routestopped,maclist,masq,modules,tcclasses,tcdevices,tcfilters,tcrules,whitelist})
license=('GPL')
depends=('iptables' 'iproute2' 'shorewall-perl')
source=(http://www.shorewall.net/pub/shorewall/4.2/$pkgname-$pkgver/$pkgname-common-$pkgver.tar.bz2)
md5sums=('49bdbbae8dec65154c4e5538ed3c9865')

build() {
  cd ${srcdir}/$pkgname-common-$pkgver
 
  sed -e 's!LOGFILE=/var/log/messages!LOGFILE=/var/log/messages.log!' -i shorewall.conf
  sed -e 's!LOGFILE=/var/log/messages!LOGFILE=/var/log/messages.log!' -i shorewall

  mv init.archlinux.sh init.sh
  DEST=/etc/rc.d INIT=shorewall PREFIX=${pkgdir} ./install.sh
  cp -rv ${srcdir}/$pkgname-common-$pkgver/Samples ${pkgdir}/usr/share/shorewall

  sed -e 's!/subsys!!' -i ${pkgdir}/etc/shorewall/shorewall.conf
}
