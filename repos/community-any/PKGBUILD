# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Maintainer: Timm Preetz <timm@preetz.us>
# Contributor: Michael 'manveru' Fellinger <m.fellinger@gmail.com>
# Contributor: Dave Pretty <david dot pretty at gmail dot com>

pkgname=anki
pkgver=1.2.8
pkgrel=2
pkgdesc='Helps you remember facts (like words/phrases in a foreign language) efficiently.'
url='http://ankisrs.net/'
license=("GPL")
arch=('any')
depends=('python2-qt' 'python2-sqlalchemy' 'python-simplejson' 'python-pysqlite' 'python-beautifulsoup')
optdepends=('python-matplotlib: show graphs'
	    'sox: audio recording'
	    'pyaudio: audio recording')
makedepends=('setuptools' 'desktop-file-utils')
source=(http://anki.googlecode.com/files/anki-$pkgver.tgz sqlalchemy.patch)

build() {
  cd $srcdir/$pkgname-$pkgver
  patch -Np1 -i $srcdir/sqlalchemy.patch
  export PYTHONPATH=$srcdir/$pkgname-$pkgver/libanki

  (cd libanki && python2 setup.py install --root $pkgdir)
  python2 setup.py install --root $pkgdir

  # .desktop file and icon
  desktop-file-install --dir $pkgdir/usr/share/applications $pkgname.desktop
  install -D -m 644 icons/$pkgname.png $pkgdir/usr/share/pixmaps/$pkgname.png
}
md5sums=('0dc5f5bad979f57cab82e3757665f6c0'
         '0e11d193c96953a780d1a64efc2131d3')
md5sums=('0dc5f5bad979f57cab82e3757665f6c0'
         'ce97c1064678436952c2773e3f1fcdb8')
