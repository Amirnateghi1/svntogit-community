# $Id$
# Maintainer: Massimiliano Torromeo <massimiliano.torromeo@gmail.com>

pkgname=nodejs-less
pkgver=2.6.1
pkgrel=2
pkgdesc="A standalone compiler for the LESS CSS language."
arch=('any')
url="http://lesscss.org/"
license=('Apache')
depends=('nodejs')
makedepends=('npm')
conflicts=('lessc')
provides=("lessc=$pkgver")
replaces=('lessc')
source=("https://registry.npmjs.org/less/-/less-$pkgver.tgz"
        "node6.patch::https://github.com/less/less.js/commit/ec04a03f1cba3a092d5cd7f7c5d8e28bb43c1932.patch")

package() {
    npm install -g --user root --prefix "$pkgdir"/usr "$srcdir"/less-$pkgver.tgz
    rm -r "$pkgdir"/usr/etc
    chmod -R go-w "$pkgdir"/usr

    cd "$pkgdir"/usr/lib/node_modules/less/bin
    patch -p2 -i "$srcdir"/node6.patch
}

sha256sums=('4a6e3c184e347dfb61e72ff89155ac9f8466aed20e904a4ffc58682ae1158e7d'
            'a172aec1a4885fcde2f088b04f0e9b95a7efe9aaf2fbd7c12dc72807f1131ede')
