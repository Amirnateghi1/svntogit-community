# Maintainer: Evgeniy Alekseev <arcanis at archlinux dot org>
# Contributor: Ray Rashif <schiv at archlinux dot org>
# Contributor: Brad Fanella <bradfanellaat archlinux dot us>
# See .contrib for older/other contributors

pkgbase=eric
pkgname=('eric-common' 'eric')
pkgver=19.11
_pkgver=19.11
pkgrel=1
pkgdesc="A full-featured Python and Ruby IDE in PyQt"
arch=('any')
url="https://eric-ide.python-projects.org/"
license=('GPL3')
depends=('python-qscintilla-qt5' 'python-pyqtwebengine' 'python-pyqtchart' 'qt5-svg')
source=("https://downloads.sourceforge.net/eric-ide/eric6-${_pkgver}.tar.gz")
sha512sums=('a8305c5185687d62231926bd4c484f3786ac1c20d125a1f8fb1b6bc0d42c57ba92bf00aaffd8699f8d7594c6432896bef8db13da85513ba4f217a60223f2f533')
changelog=ChangeLog

package_eric-common() {
  depends=()

  cd "${srcdir}/eric6-${_pkgver}/eric"
  # eric APIs
  install -Dm644 "eric6/APIs/Python3/eric6.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/eric6.api"
  install -Dm644 "eric6/APIs/Python3/eric6.bas" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/eric6.bas"
  # pyqt APIs
  install -Dm644 "eric6/APIs/Python3/PyQt5.bas" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/PyQt5.bas"
  # qss APIs
  install -Dm644 "eric6/APIs/QSS/qss.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/qss/qss.api"
  # qscintilla APIs
  install -Dm644 "eric6/APIs/Python3/QScintilla2.bas" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/QScintilla2.bas"
  # zope APIs
  install -Dm644 "eric6/APIs/Python/zope-2.10.7.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/zope-2.10.7.api"
  install -Dm644 "eric6/APIs/Python/zope-2.11.2.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/zope-2.11.2.api"
  install -Dm644 "eric6/APIs/Python/zope-3.3.1.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/python/zope-3.3.1.api"
  # ruby APIs
  install -Dm644 "eric6/APIs/Ruby/Ruby-1.8.7.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/ruby/Ruby-1.8.7.api"
  install -Dm644 "eric6/APIs/Ruby/Ruby-1.8.7.bas" \
                 "${pkgdir}/usr/share/qt/qsci/api/ruby/Ruby-1.8.7.bas"
  install -Dm644 "eric6/APIs/Ruby/Ruby-1.9.1.api" \
                 "${pkgdir}/usr/share/qt/qsci/api/ruby/Ruby-1.9.1.api"
  install -Dm644 "eric6/APIs/Ruby/Ruby-1.9.1.bas" \
                 "${pkgdir}/usr/share/qt/qsci/api/ruby/Ruby-1.9.1.bas"
}

package_eric() {
  depends=('eric-common' 'python-qscintilla-qt5'  'python-pyqtwebengine' 'qt5-svg' 'qt5-webkit')
  optdepends=('qt5-webengine: alternative browser backend')

  cd "${srcdir}/eric6-${_pkgver}"
  python install.py -c -b "/usr/bin" -i "${pkgdir}" --no-apis

  # fix paths in desktop files
  find "${pkgdir}" -name '*.desktop' -exec sed -i "s|${pkgdir}||g" {} \;
}

# vim:set ts=2 sw=2 et:
